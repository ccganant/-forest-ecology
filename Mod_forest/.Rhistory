CHH= (Peso_verde_muestra_hojas_kg-Peso_seco_muestra_hojas_kg)/Peso_verde_muestra_hojas_kg) %>%
mutate(BiomTR= Peso_verde_total_ramas_kg*(1-CHR),
BiomTH= Peso_verde_total_hojas_kg*(1-CHH)) %>%
select(N_arbol, DAP_m, Ht_m,BiomTR, BiomTH)
dbiom1<- as.tibble(dbiom1) %>% select(-c(N_arbol))
dbiom<- cbind(dbiom2, dbiom1)
dbiom<- dbiom %>% mutate(d= if_else(BiomF != "NA", 1, 0))
dbiom$BiomTR+dbiom$BiomF
sum(dbiom$BiomTR,dbiom$BiomF)
sum(dbiom$BiomTR,dbiom$BiomF, na.rm = TRUE)
dbiom<- read.csv2("biomasa_arboles.csv")
dbiom<- dbiom %>% mutate(N_arbol= as.factor(N_arbol))
dbiom1<- dbiom %>% mutate(CH= (Peso_verde_rodaja_kg-Peso_seco_rodaja_kg )/Peso_verde_rodaja_kg) %>%
mutate(Biom= Peso_total_trozas_kg*(1-CH),
Vol= Area_rodaja_m2*Espesor_rodaja_m2) %>%
mutate(WD= Peso_seco_rodaja_kg/Vol)%>% group_by(N_arbol) %>%
summarise(BiomF= sum(Biom),
WD_p= mean(WD)/1000,
vol_biom= sum(smalian(D = di_m*100, H = hi_m)))
dbiom2<- dbiom %>% filter(Peso_verde_total_ramas_kg != "NA") %>%
mutate(CHR= (Peso_verde_muestra_ramas_kg-Peso_seco_muestra_ramas_kg)/Peso_verde_muestra_ramas_kg,
CHH= (Peso_verde_muestra_hojas_kg-Peso_seco_muestra_hojas_kg)/Peso_verde_muestra_hojas_kg) %>%
mutate(BiomTR= Peso_verde_total_ramas_kg*(1-CHR),
BiomTH= Peso_verde_total_hojas_kg*(1-CHH)) %>%
select(N_arbol, DAP_m, Ht_m,BiomTR, BiomTH)
dbiom1<- as.tibble(dbiom1) %>% select(-c(N_arbol))
dbiom<- cbind(dbiom2, dbiom1)
dbiom<- dbiom %>% mutate(BIOM= sum(BiomTR +BiomTH+BiomF, na.rm= TRUE))
dbiom<- read.csv2("biomasa_arboles.csv")
dbiom<- dbiom %>% mutate(N_arbol= as.factor(N_arbol))
dbiom1<- dbiom %>% mutate(CH= (Peso_verde_rodaja_kg-Peso_seco_rodaja_kg )/Peso_verde_rodaja_kg) %>%
mutate(Biom= Peso_total_trozas_kg*(1-CH),
Vol= Area_rodaja_m2*Espesor_rodaja_m2) %>%
mutate(WD= Peso_seco_rodaja_kg/Vol)%>% group_by(N_arbol) %>%
summarise(BiomF= sum(Biom),
WD_p= mean(WD)/1000,
vol_biom= sum(smalian(D = di_m*100, H = hi_m)))
dbiom2<- dbiom %>% filter(Peso_verde_total_ramas_kg != "NA") %>%
mutate(CHR= (Peso_verde_muestra_ramas_kg-Peso_seco_muestra_ramas_kg)/Peso_verde_muestra_ramas_kg,
CHH= (Peso_verde_muestra_hojas_kg-Peso_seco_muestra_hojas_kg)/Peso_verde_muestra_hojas_kg) %>%
mutate(BiomTR= Peso_verde_total_ramas_kg*(1-CHR),
BiomTH= Peso_verde_total_hojas_kg*(1-CHH)) %>%
select(N_arbol, DAP_m, Ht_m,BiomTR, BiomTH)
dbiom1<- as.tibble(dbiom1) %>% select(-c(N_arbol))
dbiom<- cbind(dbiom2, dbiom1)
dbiom<- dbiom %>% mutate(BIOM= sum(BiomTR, BiomTH,BiomF, na.rm= TRUE))
dbiom<- read.csv2("biomasa_arboles.csv")
dbiom<- dbiom %>% mutate(N_arbol= as.factor(N_arbol))
dbiom1<- dbiom %>% mutate(CH= (Peso_verde_rodaja_kg-Peso_seco_rodaja_kg )/Peso_verde_rodaja_kg) %>%
mutate(Biom= Peso_total_trozas_kg*(1-CH),
Vol= Area_rodaja_m2*Espesor_rodaja_m2) %>%
mutate(WD= Peso_seco_rodaja_kg/Vol)%>% group_by(N_arbol) %>%
summarise(BiomF= sum(Biom),
WD_p= mean(WD)/1000,
vol_biom= sum(smalian(D = di_m*100, H = hi_m)))
dbiom2<- dbiom %>% filter(Peso_verde_total_ramas_kg != "NA") %>%
mutate(CHR= (Peso_verde_muestra_ramas_kg-Peso_seco_muestra_ramas_kg)/Peso_verde_muestra_ramas_kg,
CHH= (Peso_verde_muestra_hojas_kg-Peso_seco_muestra_hojas_kg)/Peso_verde_muestra_hojas_kg) %>%
mutate(BiomTR= Peso_verde_total_ramas_kg*(1-CHR),
BiomTH= Peso_verde_total_hojas_kg*(1-CHH)) %>%
select(N_arbol, DAP_m, Ht_m,BiomTR, BiomTH)
dbiom1<- as.tibble(dbiom1) %>% select(-c(N_arbol))
dbiom<- cbind(dbiom2, dbiom1)
dbiom<- dbiom %>% mutate(BIOM= sum(BiomTR, BiomTH,BiomF, na.rm= TRUE))
dbiom<- read.csv2("biomasa_arboles.csv")
dbiom<- dbiom %>% mutate(N_arbol= as.factor(N_arbol))
dbiom1<- dbiom %>% mutate(CH= (Peso_verde_rodaja_kg-Peso_seco_rodaja_kg )/Peso_verde_rodaja_kg) %>%
mutate(Biom= Peso_total_trozas_kg*(1-CH),
Vol= Area_rodaja_m2*Espesor_rodaja_m2) %>%
mutate(WD= Peso_seco_rodaja_kg/Vol)%>% group_by(N_arbol) %>%
summarise(BiomF= sum(Biom),
WD_p= mean(WD)/1000,
vol_biom= sum(smalian(D = di_m*100, H = hi_m)))
dbiom2<- dbiom %>% filter(Peso_verde_total_ramas_kg != "NA") %>%
mutate(CHR= (Peso_verde_muestra_ramas_kg-Peso_seco_muestra_ramas_kg)/Peso_verde_muestra_ramas_kg,
CHH= (Peso_verde_muestra_hojas_kg-Peso_seco_muestra_hojas_kg)/Peso_verde_muestra_hojas_kg) %>%
mutate(BiomTR= Peso_verde_total_ramas_kg*(1-CHR),
BiomTH= Peso_verde_total_hojas_kg*(1-CHH)) %>%
select(N_arbol, DAP_m, Ht_m,BiomTR, BiomTH)
dbiom1<- as.tibble(dbiom1) %>% select(-c(N_arbol))
dbiom<- cbind(dbiom2, dbiom1)
dbiom<- read.csv2("biomasa_arboles.csv")
dbiom<- dbiom %>% mutate(N_arbol= as.factor(N_arbol))
dbiom1<- dbiom %>% mutate(CH= (Peso_verde_rodaja_kg-Peso_seco_rodaja_kg )/Peso_verde_rodaja_kg) %>%
mutate(Biom= Peso_total_trozas_kg*(1-CH),
Vol= Area_rodaja_m2*Espesor_rodaja_m2) %>%
mutate(WD= Peso_seco_rodaja_kg/Vol)%>% group_by(N_arbol) %>%
summarise(BiomF= sum(Biom),
WD_p= mean(WD)/1000,
vol_biom= sum(smalian(D = di_m*100, H = hi_m)))
dbiom1<- dbiom1 %>% mutate(d= if_else(BiomF != "NA", 1, 0))
dbiom<- read.csv2("biomasa_arboles.csv")
dbiom<- dbiom %>% mutate(N_arbol= as.factor(N_arbol))
dbiom1<- dbiom %>% mutate(CH= (Peso_verde_rodaja_kg-Peso_seco_rodaja_kg )/Peso_verde_rodaja_kg) %>%
mutate(Biom= Peso_total_trozas_kg*(1-CH),
Vol= Area_rodaja_m2*Espesor_rodaja_m2) %>%
mutate(WD= Peso_seco_rodaja_kg/Vol)%>% group_by(N_arbol) %>%
summarise(BiomF= sum(Biom),
WD_p= mean(WD)/1000,
vol_biom= sum(smalian(D = di_m*100, H = hi_m)))
dbiom1<- dbiom1 %>% mutate(d= if_else(BiomF != "NA", 1, 8))
dbiom1[2][13]<- 1
dbiom1$BiomF[13]<- 1
dbiom<- read.csv2("biomasa_arboles.csv")
dbiom<- dbiom %>% mutate(N_arbol= as.factor(N_arbol))
dbiom1<- dbiom %>% mutate(CH= (Peso_verde_rodaja_kg-Peso_seco_rodaja_kg )/Peso_verde_rodaja_kg) %>%
mutate(Biom= Peso_total_trozas_kg*(1-CH),
Vol= Area_rodaja_m2*Espesor_rodaja_m2) %>%
mutate(WD= Peso_seco_rodaja_kg/Vol)%>% group_by(N_arbol) %>%
summarise(BiomF= sum(Biom),
WD_p= mean(WD)/1000,
vol_biom= sum(smalian(D = di_m*100, H = hi_m)))
dbiom1$BiomF[13]<- 0
dbiom1$BiomF[12]<- 0
dbiom2<- dbiom %>% filter(Peso_verde_total_ramas_kg != "NA") %>%
mutate(CHR= (Peso_verde_muestra_ramas_kg-Peso_seco_muestra_ramas_kg)/Peso_verde_muestra_ramas_kg,
CHH= (Peso_verde_muestra_hojas_kg-Peso_seco_muestra_hojas_kg)/Peso_verde_muestra_hojas_kg) %>%
mutate(BiomTR= Peso_verde_total_ramas_kg*(1-CHR),
BiomTH= Peso_verde_total_hojas_kg*(1-CHH)) %>%
select(N_arbol, DAP_m, Ht_m,BiomTR, BiomTH)
dbiom1<- as.tibble(dbiom1) %>% select(-c(N_arbol))
dbiom<- cbind(dbiom2, dbiom1)
dbiom<- dbiom %>% mutate(BIOM= BiomTR +BiomTH+ BiomF)
dbiom<- dbiom %>% select(-c(BiomTR, BiomTH, BiomF))
dbiom<- dbiom %>% mutate(DAP_cm= DAP_m*100) %>%
select(-c(DAP_m))
dbiom<- dbiom %>% arrange(N_arbol, DAP_cm,
Ht_m, BIOM, vol_biom, WD_p)
dbiom<- dbiom %>% arrange(N_arbol, DAP_cm,
Ht_m, BIOM, vol_biom, WD_p)
dbiom<- dbiom %>% arrange(N_arbol, DAP_cm,
Ht_m, BIOM, vol_biom, WD_p)
dbiom<- read.csv2("biomasa_arboles.csv")
dbiom<- dbiom %>% mutate(N_arbol= as.factor(N_arbol))
dbiom1<- dbiom %>% mutate(CH= (Peso_verde_rodaja_kg-Peso_seco_rodaja_kg )/Peso_verde_rodaja_kg) %>%
mutate(Biom= Peso_total_trozas_kg*(1-CH),
Vol= Area_rodaja_m2*Espesor_rodaja_m2) %>%
mutate(WD= Peso_seco_rodaja_kg/Vol)%>% group_by(N_arbol) %>%
summarise(BiomF= sum(Biom),
WD_p= mean(WD)/1000,
vol_biom= sum(smalian(D = di_m*100, H = hi_m)))
dbiom1$BiomF[13]<- 0
dbiom1$BiomF[12]<- 0
dbiom2<- dbiom %>% filter(Peso_verde_total_ramas_kg != "NA") %>%
mutate(CHR= (Peso_verde_muestra_ramas_kg-Peso_seco_muestra_ramas_kg)/Peso_verde_muestra_ramas_kg,
CHH= (Peso_verde_muestra_hojas_kg-Peso_seco_muestra_hojas_kg)/Peso_verde_muestra_hojas_kg) %>%
mutate(BiomTR= Peso_verde_total_ramas_kg*(1-CHR),
BiomTH= Peso_verde_total_hojas_kg*(1-CHH)) %>%
select(N_arbol, DAP_m, Ht_m,BiomTR, BiomTH)
dbiom1<- as.tibble(dbiom1) %>% select(-c(N_arbol))
dbiom<- cbind(dbiom2, dbiom1)
dbiom<- dbiom %>% mutate(BIOM= BiomTR +BiomTH+ BiomF)
dbiom<- dbiom %>% select(-c(BiomTR, BiomTH, BiomF))
dbiom<- dbiom %>% mutate(DAP_cm= DAP_m*100) %>%
select(-c(DAP_m))
dbiom<- dbiom %>% arrange(N_arbol, DAP_cm,
Ht_m, BIOM, vol_biom, WD_p)
View(dbiom)
dbiom<- read.csv2("biomasa_arboles.csv")
dbiom<- dbiom %>% mutate(N_arbol= as.factor(N_arbol))
dbiom1<- dbiom %>% mutate(CH= (Peso_verde_rodaja_kg-Peso_seco_rodaja_kg )/Peso_verde_rodaja_kg) %>%
mutate(Biom= Peso_total_trozas_kg*(1-CH),
Vol= Area_rodaja_m2*Espesor_rodaja_m2) %>%
mutate(WD= Peso_seco_rodaja_kg/Vol)%>% group_by(N_arbol) %>%
summarise(BiomF= sum(Biom),
WD_p= mean(WD)/1000,
vol_biom= sum(smalian(D = di_m*100, H = hi_m)))
dbiom2<- dbiom %>% filter(Peso_verde_total_ramas_kg != "NA") %>%
mutate(CHR= (Peso_verde_muestra_ramas_kg-Peso_seco_muestra_ramas_kg)/Peso_verde_muestra_ramas_kg,
CHH= (Peso_verde_muestra_hojas_kg-Peso_seco_muestra_hojas_kg)/Peso_verde_muestra_hojas_kg) %>%
mutate(BiomTR= Peso_verde_total_ramas_kg*(1-CHR),
BiomTH= Peso_verde_total_hojas_kg*(1-CHH)) %>%
select(N_arbol, DAP_m, Ht_m,BiomTR, BiomTH)
dbiom1<- as.tibble(dbiom1) %>% select(-c(N_arbol))
dbiom<- cbind(dbiom2, dbiom1)
dbiom<- dbiom %>% mutate(BIOM= BiomTR +BiomTH+ BiomF)
dbiom<- dbiom %>% select(-c(BiomTR, BiomTH, BiomF))
dbiom<- dbiom %>% mutate(DAP_cm= DAP_m*100) %>%
select(-c(DAP_m))
dbiom<- dbiom %>% arrange(N_arbol, DAP_cm,
Ht_m, BIOM, vol_biom, WD_p)
dbiom<- read.csv2("biomasa_arboles.csv")
dbiom<- dbiom %>% mutate(N_arbol= as.factor(N_arbol))
dbiom1<- dbiom %>% mutate(CH= (Peso_verde_rodaja_kg-Peso_seco_rodaja_kg )/Peso_verde_rodaja_kg) %>%
mutate(Biom= Peso_total_trozas_kg*(1-CH),
Vol= Area_rodaja_m2*Espesor_rodaja_m2) %>%
mutate(WD= Peso_seco_rodaja_kg/Vol)%>% group_by(N_arbol) %>%
summarise(BiomF= sum(Biom),
WD_p= mean(WD)/1000,
vol_biom= sum(smalian(D = di_m*100, H = hi_m)))
dbiom1$BiomF[13]<- 0
dbiom1$BiomF[12]<- 0
dbiom2<- dbiom %>% filter(Peso_verde_total_ramas_kg != "NA") %>%
mutate(CHR= (Peso_verde_muestra_ramas_kg-Peso_seco_muestra_ramas_kg)/Peso_verde_muestra_ramas_kg,
CHH= (Peso_verde_muestra_hojas_kg-Peso_seco_muestra_hojas_kg)/Peso_verde_muestra_hojas_kg) %>%
mutate(BiomTR= Peso_verde_total_ramas_kg*(1-CHR),
BiomTH= Peso_verde_total_hojas_kg*(1-CHH)) %>%
select(N_arbol, DAP_m, Ht_m,BiomTR, BiomTH)
dbiom1<- as.tibble(dbiom1) %>% select(-c(N_arbol))
dbiom<- cbind(dbiom2, dbiom1)
dbiom<- dbiom %>% mutate(BIOM= BiomTR +BiomTH+ BiomF)
dbiom<- dbiom %>% select(-c(BiomTR, BiomTH, BiomF))
dbiom<- dbiom %>% mutate(DAP_cm= DAP_m*100) %>%
select(-c(DAP_m))
dbiom<- dbiom %>% arrange(N_arbol, DAP_cm,
Ht_m, BIOM, vol_biom, WD_p)
dbiom<- read.csv2("biomasa_arboles.csv")
dbiom<- dbiom %>% mutate(N_arbol= as.factor(N_arbol))
dbiom1<- dbiom %>% mutate(CH= (Peso_verde_rodaja_kg-Peso_seco_rodaja_kg )/Peso_verde_rodaja_kg) %>%
mutate(Biom= Peso_total_trozas_kg*(1-CH),
Vol= Area_rodaja_m2*Espesor_rodaja_m2) %>%
mutate(WD= Peso_seco_rodaja_kg/Vol)%>% group_by(N_arbol) %>%
summarise(BiomF= sum(Biom),
WD_p= mean(WD)/1000,
vol_biom= sum(smalian(D = di_m*100, H = hi_m)))
dbiom1$BiomF[13]<- 0
dbiom1$BiomF[12]<- 0
dbiom2<- dbiom %>% filter(Peso_verde_total_ramas_kg != "NA") %>%
mutate(CHR= (Peso_verde_muestra_ramas_kg-Peso_seco_muestra_ramas_kg)/Peso_verde_muestra_ramas_kg,
CHH= (Peso_verde_muestra_hojas_kg-Peso_seco_muestra_hojas_kg)/Peso_verde_muestra_hojas_kg) %>%
mutate(BiomTR= Peso_verde_total_ramas_kg*(1-CHR),
BiomTH= Peso_verde_total_hojas_kg*(1-CHH)) %>%
select(N_arbol, DAP_m, Ht_m,BiomTR, BiomTH)
dbiom1<- as.tibble(dbiom1) %>% select(-c(N_arbol))
dbiom<- cbind(dbiom2, dbiom1)
dbiom<- dbiom %>% mutate(BIOM= BiomTR +BiomTH+ BiomF)
dbiom<- dbiom %>% select(-c(BiomTR, BiomTH, BiomF))
dbiom<- dbiom %>% mutate(DAP_cm= DAP_m*100) %>%
select(-c(DAP_m))
dbiom<- dbiom %>% select(N_arbol, DAP_cm,
Ht_m, BIOM, vol_biom, WD_p)
View(dbiom)
View(dval)
data<- read.csv2("Parcial_3_volumen.csv")
data1<- data %>% mutate(No_.arbol= as.factor(No_.arbol)) %>%
group_by(No_.arbol) %>%
summarise(smalian= sum(smalian(di, hi)))
data<- data %>% mutate(No_.arbol= as.factor(No_.arbol)) %>%
group_by(No_.arbol) %>% summarise(DAP= unique(D), altura= unique(H))
data1<- as.tibble(data1) %>% select(-c(No_.arbol))
data1<- cbind(data, data1)
set.seed(32)
nr<- sample(75, 22)
dval<- data %>% slice(nr)
set.seed(32)
nr<- sample(75, 22)
dval<- data1 %>% slice(nr)
dval<- dval %>% mutate(V3= 4.065e-05*DAP^6.15*altura^3.28,
V4= 5.81e-05*(DAP^2*altura)^2.61) %>%
mutate(val3= (smalian-V3)/smalian,
val4= (smalian-v4)/smalian)
dval<- dval %>% mutate(V3= 4.065e-05*DAP^6.15*altura^3.28,
V4= 5.81e-05*(DAP^2*altura)^2.61) %>%
mutate(val3= (smalian-V3)/smalian,
val4= (smalian-V4)/smalian)
dval<- dval %>% summarise(Media3= mean(val3), sd3= sd(val3),
Media4= mean(val4), sd4= sd(val4))
set.seed(32)
nr<- sample(75, 22)
dval<- data1 %>% slice(nr)
dval<- dval %>% mutate(V3= 4.065e-05*DAP^6.15*altura^3.28,
V4= 5.81e-05*(DAP^2*altura)^2.61) %>%
mutate(val3= ((smalian-V3)/smalian)*100,
val4= ((smalian-V4)/smalian))*100)
set.seed(32)
nr<- sample(75, 22)
dval<- data1 %>% slice(nr)
dval<- dval %>% mutate(V3= 4.065e-05*DAP^6.15*altura^3.28,
V4= 5.81e-05*(DAP^2*altura)^2.61) %>%
mutate(val3= ((smalian-V3)/smalian)*100,
val4= ((smalian-V4)/smalian)*100)
dval<- dval %>% summarise(Media3= mean(val3), sd3= sd(val3),
Media4= mean(val4), sd4= sd(val4))
modelo<- lm(log(smalian) ~ log(I(DAP^2*altura)), data1)
prueba<- broom::augment(modelo)
View(prueba)
set.seed(32)
nr<- sample(75, 22)
dval<- data1 %>% slice(nr)
dval<- dval %>% mutate(V3= 4.065e-05*DAP^6.15*altura^3.28,
V4= 5.81e-05*(DAP^2*altura)^2.61)
modelo<- lm(log(smalian) ~ log(DAP) + log(altura), data1)
a<- shapiro.test(resid(modelo))
prueba<- broom::augment(modelo)
prueba<- prueba %>% mutate(fitted=
exp(((anova(modelo)$"Mean Sq"[2])/2)+(-10.11047)+1.81712*log.DAP.+1.18930*log.altura.)) %>%
mutate(resid= fitted - exp(log.smalian.))
((anova(modelo)$"Mean Sq"[2])/2)+(-10.11047)
exp(((anova(modelo)$"Mean Sq"[2])/2)+(-10.11047))
dval<- dval %>% mutate(V3= exp(-7.353183+ 1.81712*log(DAP)+1.18930*log(altura)),
V4= 5.81e-05*(DAP^2*altura)^2.61)
modelo<- lm(log(smalian) ~ log(I(DAP^2*altura)), data1)
a<- shapiro.test(resid(modelo))
prueba<- broom::augment(modelo)
prueba<- prueba %>% mutate(fitted=
exp(((anova(modelo)$"Mean Sq"[2])/2)+(-9.7530)+0.9581*log.I.DAP.2...altura..)) %>%
mutate(resid= fitted - exp(log.smalian.))
exp(((anova(modelo)$"Mean Sq"[2])/2)+(-9.7530))
((anova(modelo)$"Mean Sq"[2])/2)+(-9.7530)
dval<- dval %>% mutate(V3= exp(-7.353183+ 1.81712*log(DAP)+1.18930*log(altura)),
V4= exp(-9.741563)+0.9581*log(DAP^2*altura))
set.seed(32)
nr<- sample(75, 22)
dval<- data1 %>% slice(nr)
dval<- dval %>% mutate(V3= exp(-7.353183+ 1.81712*log(DAP)+1.18930*log(altura)),
V4= exp(-9.741563+0.9581*log(DAP^2*altura)))
set.seed(32)
nr<- sample(75, 22)
dval<- data1 %>% slice(nr)
dval<- dval %>% mutate(V3= exp(-7.353183+ 1.81712*log(DAP)+1.18930*log(altura)),
V4= exp(-9.741563+0.9581*log(DAP^2*altura))) %>%
mutate(val3= ((smalian-V3)/smalian)*100,
val4= ((smalian-V4)/smalian)*100)
dval<- dval %>% summarise(Media3= mean(val3), sd3= sd(val3),
Media4= mean(val4), sd4= sd(val4))
knitr::opts_chunk$set(echo = FALSE,
warning = FALSE,
message = FALSE)
library(tidyverse)
library(agricolae)
library(BIOMASS)
library(modelr)
smalian<- function(D, H){
x<- c()
for (i in 1:(NROW(D)-1)){
val<- (pi/80000)*((D[i]^2+D[i+1]^2))*(H[i+1]-H[i])
x[i]<- val
}
return(x)
}
dbiom<- read.csv2("biomasa_arboles.csv")
dbiom<- dbiom %>% mutate(N_arbol= as.factor(N_arbol))
dbiom1<- dbiom %>% mutate(CH= (Peso_verde_rodaja_kg-Peso_seco_rodaja_kg )/Peso_verde_rodaja_kg) %>%
mutate(Biom= Peso_total_trozas_kg*(1-CH),
Vol= Area_rodaja_m2*Espesor_rodaja_m2) %>%
mutate(WD= Peso_seco_rodaja_kg/Vol)%>% group_by(N_arbol) %>%
summarise(BiomF= sum(Biom),
WD_p= mean(WD)/1000,
vol_biom= sum(smalian(D = di_m*100, H = hi_m)))
dbiom1$BiomF[13]<- 0
dbiom1$BiomF[12]<- 0
dbiom2<- dbiom %>% filter(Peso_verde_total_ramas_kg != "NA") %>%
mutate(CHR= (Peso_verde_muestra_ramas_kg-Peso_seco_muestra_ramas_kg)/Peso_verde_muestra_ramas_kg,
CHH= (Peso_verde_muestra_hojas_kg-Peso_seco_muestra_hojas_kg)/Peso_verde_muestra_hojas_kg) %>%
mutate(BiomTR= Peso_verde_total_ramas_kg*(1-CHR),
BiomTH= Peso_verde_total_hojas_kg*(1-CHH)) %>%
select(N_arbol, DAP_m, Ht_m,BiomTR, BiomTH)
dbiom1<- as.tibble(dbiom1) %>% select(-c(N_arbol))
dbiom<- cbind(dbiom2, dbiom1)
dbiom<- dbiom %>% mutate(BIOM= BiomTR +BiomTH+ BiomF)
dbiom<- dbiom %>% select(-c(BiomTR, BiomTH, BiomF))
dbiom<- dbiom %>% mutate(DAP_cm= DAP_m*100) %>%
select(-c(DAP_m))
dbiom<- dbiom %>% select(N_arbol, DAP_cm,
Ht_m, BIOM, vol_biom, WD_p)
set.seed(26)
nr<- sample(31, 25)
dmodel<- dbiom %>% slice(nr)
set.seed(26)
nr<- sample(31, 6)
dval<- dbiom %>% slice(nr)
modelo<- lm(log(BIOM) ~ I(log(DAP_cm^2*WD_p)), dbiom)
a<- shapiro.test(resid(modelo))
prueba<- broom::augment(modelo)
exp(((anova(modelo)$"Mean Sq"[2])/2)+(-1.53457 ))
((anova(modelo)$"Mean Sq"[2])/2)+(-1.53457 )
View(dval)
dval<- dval %>% mutate(V_e= exp(-1.475058+ 1.17380*log(DAP_cm^2*WD_p))) %>%
mutate(val_e= ((BIOM-V_e)/BIOM)*100)
dval<- dval %>% summarise(Media_e= mean(val3), sd_e= sd(val3))
dval<- dval %>% summarise(Media_e= mean(val_e), sd_e= sd(val_e))
dval
modelo<- lm(log(BIOM) ~ I(log(DAP_cm^2*Ht_m*WD_p)), dmodel)
broom::glance(modelo)
modelo<- lm(log(BIOM)  ~ I(log(DAP_cm^2*Ht_m)), dbiom)
broom::glance(modelo)
modelo<- lm(log(BIOM) ~ I(log(DAP_cm^2*Ht_m*WD_p)), dmodel)
broom::glance(modelo)
a<- shapiro.test(resid(modelo))
prueba<- broom::augment(modelo)
prueba<- prueba %>% mutate(fitted=
exp(((anova(modelo)$"Mean Sq"[2])/2)+(-1.82526)+
0.83840*I.log.DAP_cm.2...Ht_m...WD_p..)) %>%
mutate(resid= fitted - exp(log.BIOM.))
RSE <- sqrt(sum(prueba$resid^2, na.rm = TRUE)/summary(modelo)$df[2])
tabla6<- tibble(Modelo= "BA= 0.18*(D^2*H*WD)^2.31",
Fc= round(broom::glance(modelo)$statistic, 4),
valor.p= "***",
Shapiro= round(a$p.value, 4),
R.squared= round(broom::glance(modelo)$r.squared, 4),
AIC= broom::glance(modelo)$AIC,
RSE= round(RSE, 4))
tabla6
modelo<- lm(log(BIOM) ~ I(log(DAP_cm^2*Ht_m*WD_p)), dmodel)
prueba<- broom::augment(modelo)
ggplot(dbiom, mapping = aes(x= DAP_cm^2*WD_p, y= BIOM)) +
geom_point() +
geom_smooth(prueba, mapping = aes(x= exp(I.log.DAP_cm.2...WD_p..),
y= fitted)) +
labs(y= "Biomasa (kg)")
names(prueba)
ggplot(dbiom, mapping = aes(x= DAP_cm^2*WD_p, y= BIOM)) +
geom_point() +
geom_smooth(prueba, mapping = aes(x= exp(I.log.DAP_cm.2...Ht_m...WD_p..),
y= fitted)) +
labs(y= "Biomasa (kg)")
ggplot(dbiom, mapping = aes(x= DAP_cm^2*WD_p, y= BIOM)) +
geom_point() +
geom_smooth(prueba, mapping = aes(x= exp(I.log.DAP_cm.2...Ht_m...WD_p..), y= fitted)) +
labs(y= "Biomasa (kg)")
ggplot(dbiom, mapping = aes(x= DAP_cm^2*WD_p, y= BIOM)) +
geom_point()
modelo<- lm(log(BIOM) ~ I(log(DAP_cm^2*Ht_m*WD_p)), dmodel)
a<- shapiro.test(resid(modelo))
prueba<- broom::augment(modelo)
prueba<- prueba %>% mutate(fitted=
exp(((anova(modelo)$"Mean Sq"[2])/2)+(-1.82526)+
0.83840*I.log.DAP_cm.2...Ht_m...WD_p..)) %>%
mutate(resid= fitted - exp(log.BIOM.))
ggplot(dbiom, mapping = aes(x= DAP_cm^2*WD_p, y= BIOM)) +
geom_point() +
geom_smooth(prueba, mapping = aes(x= exp(I.log.DAP_cm.2...Ht_m...WD_p..), y= fitted)) +
labs(y= "Biomasa (kg)")
ggplot(dbiom, mapping = aes(x= DAP_cm^2*Ht_m*WD_p, y= BIOM)) +
geom_point() +
geom_smooth(prueba, mapping = aes(x= exp(I.log.DAP_cm.2...Ht_m...WD_p..), y= fitted)) +
labs(y= "Biomasa (kg)")
((anova(modelo)$"Mean Sq"[2])/2)+(-1.82526)
dval<- dval %>% mutate(V_g= exp(-1.737838+ 0.83840*log(DAP_cm^2*Ht_m*WD_p))) %>%
mutate(val_g= ((BIOM-V_g)/BIOM)*100)
set.seed(26)
nr<- sample(31, 6)
dval<- dbiom %>% slice(nr)
dval<- dval %>% mutate(V_g= exp(-1.737838+ 0.83840*log(DAP_cm^2*Ht_m*WD_p))) %>%
mutate(val_g= ((BIOM-V_g)/BIOM)*100)
dval<- dval %>% summarise(Media_g= mean(val_g), sd_e= sd(val_g))
dval
#BA= exp(-1.475058+1.17380*(DAP^2*WD))
data<- read.csv2("biom_plots_parcial.csv")
#BA= exp(-1.737838+ 0.83840*log(DAP_cm^2*Ht_m*WD_p))
data<- read.csv2("biom_plots_parcial.csv")
model1<- modelHD(data$DAP_cm, data$Altura_m, method = "log1")# mejor modelo por AIC
model2<- modelHD(data$DAP_cm, data$Altura_m, method = "weibull")
data<- data %>% mutate(fitted= exp(model1$coefficients[1]+model1$RSElog/2)*
DAP_cm^model1$coefficients[2]) %>%
mutate(Altura_m= if_else(!is.na(Altura_m), Altura_m, fitted))
data1<- data %>% group_by(Localidad) %>%
mutate(Vol= exp(-9.7530+0.9581*log((DAP_cm*100)^2*Altura_m))) %>%
mutate(`Vol (m^3)/ha`= Vol*0.04)
View(data)
names(data)
data2<- data %>% group_by(Localidad) %>%
mutate(BA= exp(-1.737838+ 0.83840*log(DAP_cm^2*Altura_m*WD))) %>%
mutate(`BA (Ton/ha)` = (25/1000)*BA)
anova<- aov(`BA (Ton/ha)` ~ Localidad, data= data2)
a<- HSD.test(anova, trt = "Localidad", console = F)
a
data2<- data %>% group_by(Localidad) %>%
mutate(BA= exp(-1.737838+ 0.83840*log(DAP_cm^2*Altura_m*WD))) %>%
mutate(`BA (Ton/ha)` = (25/1000)*BA)
data2
anova<- aov(`BA (Ton/ha)` ~ Localidad, data= data2)
a<- HSD.test(anova, trt = "Localidad", console = F)
a
data2<- data2 %>% mutate(Grupo= if_else(Localidad== "Maceo", "a",
if_else(Localidad == "Caicedo", "ab", "b")))
ggplot(data2, mapping = aes(x= Localidad, y= `BA (Ton/ha)`)) +
geom_boxplot(mapping = aes(fill= Grupo))
data2 %>%  summarise(Media= mean(`BA (Ton/ha)`),
Desviacion= sd(`BA (Ton/ha)`)) %>%
mutate(`media contenido de C`= Media*0.5,
`Sd contenido de C`= Desviacion*0.5)
Desviacion= sd(`Vol (m^3)/ha`)
data1 %>%  summarise(Media= mean(`Vol (m^3)/ha`),
Desviacion= sd(`Vol (m^3)/ha`))
as.tibble(data1) %>%  summarise(Media= mean(`Vol (m^3)/ha`),
Desviacion= sd(`Vol (m^3)/ha`))
as.tibble(data2) %>%  summarise(Media= mean(`BA (Ton/ha)`),
Desviacion= sd(`BA (Ton/ha)`)) %>%
mutate(`media contenido de C`= Media*0.5,
`Sd contenido de C`= Desviacion*0.5)
as.tibble(data2) %>%  summarise(Media= mean(`BA (Ton/ha)`),
Desviacion= sd(`BA (Ton/ha)`)) %>%
mutate(`media contenido de C`= Media*0.5,
`Sd contenido de C`= Desviacion*0.5) %>%
select(`media contenido de C`, `Sd contenido de C`)
90*120
((anova(modelo)$"Mean Sq"[2])/2)+(-1.53457 )
dval<- dval %>% mutate(V_g= exp(-1.737838+ 0.83840*log(DAP_cm^2*Ht_m*WD_p)),
V_e= exp(-1.447148+1.17380*log(DAP_cm^2*WD_p))) %>%
mutate(val_g= ((BIOM-V_g)/BIOM)*100,
val_e= ((BIOM-V_e)/BIOM)*100)
set.seed(26)
nr<- sample(31, 6)
dval<- dbiom %>% slice(nr)
dval<- dval %>% mutate(V_g= exp(-1.737838+ 0.83840*log(DAP_cm^2*Ht_m*WD_p)),
V_e= exp(-1.447148+1.17380*log(DAP_cm^2*WD_p))) %>%
mutate(val_g= ((BIOM-V_g)/BIOM)*100,
val_e= ((BIOM-V_e)/BIOM)*100)
dval<- dval %>% summarise(Media_g= mean(val_g), sd_g= sd(val_g),
Media_e= mean(val_e), sd_e= sd(val_g))
dval
set.seed(26)
nr<- sample(31, 6)
dval<- dbiom %>% slice(nr)
dval<- dval %>% mutate(V_g= exp(-1.737838+ 0.83840*log(DAP_cm^2*Ht_m*WD_p)),
V_e= exp(-1.447148+1.17380*log(DAP_cm^2*WD_p))) %>%
mutate(val_g= ((BIOM-V_g)/BIOM)*100,
val_e= ((BIOM-V_e)/BIOM)*100)
dval<- dval %>% summarise(Media_g= mean(val_g), sd_g= sd(val_g),
Media_e= mean(val_e), sd_e= sd(val_e))
dval
