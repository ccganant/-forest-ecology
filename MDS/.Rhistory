setwd("~/forest/MDS")
knitr::opts_chunk$set(echo = TRUE,
message = FALSE,
warning = FALSE)
library(tidyverse)
library(dismo)
file<- paste0(system.file(package = "dismo"), "/ex/bradypus.csv")
datasp<- read_csv(file)
# Variable Dependiente
datasp<- datasp %>% dplyr::select(lon, lat)
load("datad.Rdata")
datad<- datad %>% filter(lat != "NA" & lon != "NA")
library(maptools)
data(wrld_simpl)
plot(wrld_simpl, xlim=c(-80,70), ylim=c(-60,60), axes=TRUE, col="light yellow")
box()
points(datad$lon, datad$lat, col='orange', pch=20, cex=0.75)
plot(wrld_simpl, xlim=c(-80,70), ylim=c(-60,60), axes=TRUE, col="light yellow")
box()
points(datad$lon, datad$lat, col='orange', pch=20, cex=0.75)
load("filas.Rdata")
datad<- datad %>% slice(-as.numeric(c(filas$x)))
coordinates(datad)<- ~lon+lat
crs(datad) <- crs(wrld_simpl)
ovr<- over(datad, wrld_simpl) # Contiene para cada punto, el registro correspondiente de wrld_simpl
ovr<- ovr$NAME
i<- which(ovr != datad$country)
plot(datad)
plot(wrld_simpl, add=T, border='blue', lwd=2)
points(datad[i, ], col='red', pch=20, cex=2)
path <- file.path(system.file(package="dismo"), 'ex')
capas <- list.files(path, pattern='grd$', full.names=TRUE )
conjunto<- stack(capas) # Unir capas
plot(conjunto)
plot(conjunto, 1)
plot(wrld_simpl, add= TRUE)
plot(conjunto, 1)
plot(wrld_simpl, add= TRUE)
points(datasp, col= "red")
ocurrencia<- extract(conjunto, datasp)
set.seed(0)
i<- randomPoints(conjunto, 500)
ausencia<- extract(conjunto, i)
ocurrencia<- as.tibble(ocurrencia) %>% mutate(ap= 1)
ausencia<- as.tibble(ausencia) %>% mutate(ap= 0)
conjunto<- rbind(ocurrencia, ausencia) %>% mutate(biome= as.factor(biome),
ap= as.factor(ap))
library(GGally)
conjunto[, 1:8] %>% ggpairs(., ggplot2::aes(colour= conjunto$ap)) + theme(legend.position = "top")
conjunto<- conjunto %>% mutate(ap= as.numeric(as.character(ap)))
model<- glm(ap ~ ., data=conjunto)
broom::tidy(model)
broom::augment(model)
broom::glance(model)
broom::tidy(model)
model<- glm(ap ~ bio16 + bio12, data=conjunto)
ggplot(data= conjunto, mapping = aes(x= ap, y= bio16+bio12)) +
geom_point()
ggplot(data= conjunto, mapping = aes(x= ap, y= bio16+bio12)) +
geom_point() + geom_smooth(method = "glm")
model<- glm(ap ~ bio16 + bio12+ bio5, data=conjunto)
modelb<- bioclim(ocurrencia[,c("bio16", "bio12", "bio5")])
modelb
ocurrencia[,c("bio16", "bio12", "bio5")]
class(modelb)
pairs(modelb)
pairs(ocurrencia[,c("bio16", "bio12", "bio5")])
pairs(ocurrencia[,c("bio16", "bio12", "bio5")])
pairs(modelb)
pairs(modelb)
pairs(ocurrencia[,c("bio16", "bio12", "bio5")])
ggpairs(ocurrencia[,c("bio16", "bio12", "bio5")])
ggpairs(modelb)
broom::augment(modelb)
plot(conjunto)
path <- file.path(system.file(package="dismo"), 'ex')
capas <- list.files(path, pattern='grd$', full.names=TRUE )
conjunto<- stack(capas) # Unir capas
plot(conjunto)
conjunto<- stack(capas) # Unir capas
conjunto
names(conjunto)
i<- predict(model, conjunto)
i<- predict(conjunto, model)
plot(i)
